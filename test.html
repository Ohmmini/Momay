<!DOCTYPE html>
<html lang="th">
<head>

  <script>
    const msg = document.getElementById('msg');
    const isSecure = location.protocol === 'https:' ||
      ['localhost','127.0.0.1','::1'].includes(location.hostname);

    function note(s){ msg.textContent = s }

    function attachOneShotPermissionAsk(){
      // ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ user gesture ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
      const events = ['click','keydown','touchstart','wheel','scroll'];
      const handler = async () => {
        events.forEach(e => window.removeEventListener(e, handler, { passive:true }));
        try {
          const res = await Notification.requestPermission();
          if (res === 'granted') {
            note('‚úÖ ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÅ‡∏•‡πâ‡∏ß (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á)');
            try { new Notification('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß üéâ', { body:'‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï' }); } catch {}
          } else if (res === 'denied') {
            note('‚ùå ‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏î ‚Äú‡∏ö‡∏•‡πá‡∏≠‡∏Å‚Äù ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Site settings ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå');
          } else {
            note('‚ÑπÔ∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (default)');
          }
        } catch (e) {
          note('‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + e.message);
        }
      };
      events.forEach(e => window.addEventListener(e, handler, { passive:true, once:true }));
      note('‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß: ‡πÅ‡∏Ñ‡πà‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (‡∏Ñ‡∏•‡∏¥‡∏Å/‡∏Å‡∏î‡∏Ñ‡∏µ‡∏¢‡πå/‡∏™‡∏Å‡∏£‡∏≠‡∏•) ‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ');
    }

    document.addEventListener('DOMContentLoaded', () => {
      if (!('Notification' in window)) {
        note('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Notification API');
        return;
      }
      if (!isSecure) {
        note('‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ HTTPS ‡∏´‡∏£‡∏∑‡∏≠ localhost/127.0.0.1/::1 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå');
        return;
      }

      const p = Notification.permission; // default | granted | denied
      if (p === 'default') {
        attachOneShotPermissionAsk();
      } else if (p === 'granted') {
        note('‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
      } else if (p === 'denied') {
        note('‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‚ùå ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Site settings ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡∏°‡πà');
      }
    });
  </script>
</body>
</html>
